= Leo IOT Dashboard

Dieses Repository beinhaltet die Dokumentation zum Einrichten und Verwalten des IOT Dashboards der HTL Leonding mit Grafana. (Template Dashboard Anleitung siehe https://github.com/2223-4bhitm-itp/2223-4bhitm-project-iot-dashboard/tree/main/docs/deployment[hier]).

== Projektziel

Das Projektzeil ist die Visualisierung der Raumklimata der HTL Leonding und ein Dashboard für die Admin Verwaltung der Sensorboxen des Leo IOT Dashboards.


=== UCD

image::https://www.plantuml.com/plantuml/png/bP2nJiD038PtFuNLfNHeAzAj0oegRr2LtUHCSjBbhjW-A23UdKiW5KXa88lj-Fx__-IT6edbBi2yDJlfThq-1OhzdrMTkhNoK-POyz9vQeGwWFbnVuVBgGy2FnfQGl5DQ-YyS6q-HO2-eTW4niEh6dT8EdRlW9YLQrB6sRtNJC6_CL9HFfSI7VhuFIX7JO8FwSmwwosE-sluMyuYISP7rNyZHk5cmjsHqGWmOMwjiBOfEBmD9Dq5fO8FWAkYM-3g1ajJBN2BV3QEJg6VnyNcvsAuV8MJbo_uIVfyVc4PiWvrcr80-Af5ES3-7WUGIs0reFXOX-mOO5U2SnS-0G00[]


=== Sprints siehe YouTrack
* *22-11-2022: Bis 29-11-2022:*
** Wireframe vom Dashboard
** Quarkus Application ansehen

* *Start: 13-12-2022*
** Daten von MQTT-Server auf lokalem Dashboard anzeigen

==== Liste: Was soll dargestellt werden?

* *Viewer*
** 2D-Modell von HTL Leonding
** Informationen über Raum nummerisch dargestellt (Temperatur, CO2-Wert, Luftfeuchtigkeit, Lautstärke, Helligkeit)
** Daten als Graph visualisieren, wobei man einstellen kann, welchen Wert man sich ansehen will
** Aktive und passive Boxen
** Alerts
*** Grenzwertüberschreitungen
*** große Wertsprünge (Hysterese)
** Errors
*** Sensorausfall
*** Sensorboxausfall
*** MQTT-Server Error

* *29-11-2022: Bis 06-12-2022:*
** Detail Daten werden von faker MQTT angezeigt
** GUI wird überarbeitet
** UCD wird überarbeitet


=== Wireframe
==== Dashboard View
image::docs/img/Wireframe.png[]


* *Bis zum Tag der offenen Tür*
** Original dashboard mit Grafana bestücken
** Schwellwerte anzeigen

image::docs/img/Concept.png[]

=== *Nach Tag der offenen Tür*
** Neues Subnet für Docker definieren
*** 10.0.1.  /16
** Eine Liste von den Schritten wie wir alles installiert haben

=== *Besprechung am 07.02.2023*
** Zielsetzung
*** System Architecture zeichnen und aufbauen
*** *Als Schüler möchte ich nach dem klick auf den räum e61 die Grafik der Temperatur usw sehen.*
*** *Das Team hat die Leo boxen zu übernehmen*
*** *Eine Leo Box ist in der 4BHITM zu installieren*
*** *Das Team muss Leo Boxen flashen und mit ihnen kommunizieren können*
*** Wie spreche ich mit einer Leo Box?
*** Wie konfiguriere, flashe ich sie?
*** Umstellung auf secure MQTT
*** Genaue Definition des Dashboards
*** Situation der Repos muss unter Kontrolle gebracht werden

=== *Besprechung am 14.02.2023*
** Amerikanisches auf Europäisches Datum umstellen
** Datenbanken verstehen -> Wie kommen welche Daten wo hin
** Boxen -> *Welche* boxen und *wieviele* bekommen wir?
** Dasboard auf einer plain HTML seite
*** Soll auf der VM laufen
*** Soll durch eine URL erreichbar sein

=== How to update VM139 dashboard

* Im Dashboard Repository folgende Befehle nach Änderungen ausführen:
** docker build -t ghcr.io/leo-iot/leo-iot-web/app .
** docker push ghcr.io/leo-iot/leo-iot-web/app

* Dann auf der VM im Ordner /opt/docker/leo-iot folgende Befehle ausführen
** docker-compose pull
** docker-compose stop
** docker-compose rm -f
** docker-compose up -d


=== How to configure LeoBox
** Connect Box to power grid
** If the green light blinks, connect to Box
via accespoint ESP..
** Configure the Box via HTTP GET requests:
** check the current config:
*** 'http://192.168.4.1/config'
** set the right name for level and room number
*** 'http://192.168.4.1/config?thingname=stockwerk/roomname'
** set the right name for level and room number
*** 'http://192.168.4.1/config?thingname=stockwerk/roomname'
** connect the box to a network
*** 'http://192.168.4.1/config?ssid=iot'
*** 'http://192.168.4.1/config?password=passme'
** restart the box
*** 'http://192.168.4.1/restart'

https://github.com/gkoe/esp-idf_21/blob/main/esp%20config.txt[Further configuration options]
